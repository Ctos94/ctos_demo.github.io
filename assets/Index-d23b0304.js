import{_ as e}from"./Sider-d23e21e2.js";import{_ as t,a as s,x as a,o as r,c as l,w as o,y as i,b as n,E as u,z as c,k as d,r as p,l as m,d as f,F as h,u as _,g,A as v,B as y}from"./index-9ae1d4ba.js";const x=t({props:{limit:{type:Number},multiple:{type:Boolean,default:!1},param_name:{type:String,default:"file"},btn_text:{type:String,default:"点击上传"},upload_url:{type:String},show_file_list:{type:Boolean,default:!1},list_type:{type:String,default:"text"},accept:{type:String},data:{type:Object,default:function(){return{}}}},data:()=>({fullscreenLoading:!1}),computed:{headers(){let e={},t=sessionStorage.getItem("AccessToken");return t&&(e.Authorization=`Bearer ${t}`),e}},methods:{success(e,t,s){0==e.success?this.$message.error(e.msg):this.$emit("on-success",e.data,t,s),this.fullscreenLoading=!1},error(e){403!==JSON.parse(JSON.stringify(e)).status?this.fullscreenLoading=!1:this.$router.push("/login")},exceed(){this.$message.error("最多只能上传"+this.limit+"个文件")},clearFiles(){this.$refs.uploader.clearFiles()},remove(){this.$emit("on-success")},progress(e,t,s){this.$emit("on-progress",e,t,s)}}},[["render",function(e,t,d,p,m,f){const h=s("v-btn"),_=u,g=c;return a((r(),l(_,{ref:"uploader",data:d.data,name:this.param_name,limit:this.limit,action:this.upload_url,multiple:d.multiple,headers:f.headers,"show-file-list":this.show_file_list,"list-type":this.list_type,"on-success":f.success,"on-error":f.error,"on-exceed":f.exceed,"on-remove":f.remove,"on-progress":f.progress,accept:this.accept,"before-upload":()=>{this.fullscreenLoading=!0}},{default:o((()=>[i(e.$slots,"default",{},(()=>[n(h,{color:"blue-lighten-1",text:d.btn_text},null,8,["text"])]))])),_:3},8,["data","name","limit","action","multiple","headers","show-file-list","list-type","on-success","on-error","on-exceed","on-remove","on-progress","accept","before-upload"])),[[g,m.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])}]]),b=t({__name:"Index",setup(t){const a=d(),i=p(null),u=v.bill.import,c=p(!0);m((()=>{a.commit("update_header_active","BILL_INDEX")}));const b=()=>{i.value.clearFiles(),c.value=!1,y((()=>{c.value=!0}))};return(t,a)=>{const d=s("v-navigation-drawer"),p=s("router-view"),m=s("v-container"),v=s("v-main");return r(),f(h,null,[n(d,{width:"200"},{default:o((()=>[n(e),n(x,{class:"uploader",ref_key:"uploaderRef",ref:i,upload_url:_(u),btn_text:"导入账单",accept:".csv",onOnSuccess:b},null,8,["upload_url"])])),_:1}),n(v,null,{default:o((()=>[n(m,null,{default:o((()=>[c.value?(r(),l(p,{key:0})):g("",!0)])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-98cc27c7"]]);export{b as default};
